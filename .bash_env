old_bash_env="${BASH_ENV}"
unset BASH_ENV

umask 022
export TMOUT=0

export SCREENDIR="$HOME/.screen"
mkdir --mode=700 --parents "$SCREENDIR"

export AC_GIT_DIR="$HOME/git"
export AC_ESSENTIALS_DIR="${AC_GIT_DIR}/ac-essentials"
export AC_CHROMA_UTILS_DIR="${AC_GIT_DIR}/ac-chroma-utils"

ac_python_dir="${AC_ESSENTIALS_DIR}/ac-python"
ac_tex_dir="${AC_ESSENTIALS_DIR}/ac-tex"

ac-envvar-push-front() {
    local varname="${1}"
    shift
    for ((i=$#;i>0;i--)) ; do
        newvalue="${!i}"
	if [[ -z "${!varname:-}" ]] ; then
	    export "${varname}"="${newvalue}:"
	elif [[ ":${!varname}:" != *":${newvalue}:"* ]] ; then
	    export "${varname}"="${newvalue}:${!varname}"
	fi
    done
}

# ac-envvar-push-back() {
#     local varname="${1}"
#     shift
#     for newvalue in "$@" ; do
# 	if [[ -z "${!varname:-}" ]] ; then
# 	    export "${varname}"="${newvalue}:"
# 	elif [[ ":${!varname}:" != *":${newvalue}:"* ]] ; then
# 	    export "${varname}"="${!varname}:${newvalue}"
# 	fi
#     done
# }

ac-envvar-push-front PATH \
	       "${AC_ESSENTIALS_DIR}/bin" \
	       "${AC_ESSENTIALS_DIR}/lib" \
	       "${AC_CHROMA_UTILS_DIR}" \
	       "$HOME/bin" \
	       "$HOME/local/bin" \
	       "$HOME/.local/bin" \
	       "$HOME/local/anaconda/bin" \

ac-envvar-push-front MANPATH \
	       "${HOME}/man" \
	       "${HOME}/share/man"

ac-envvar-push-front PYTHONPATH "." "${ac_python_dir}" "${ac_python_dir}"

ac-envvar-push-front TEXINPUTS "." "${ac_tex_dir}//"
ac-envvar-push-front BIBINPUTS "." "${ac_tex_dir}"
ac-envvar-push-front BSTINPUTS "." "${ac_tex_dir}"

export BASH_ENV="${old_bash_env}"
