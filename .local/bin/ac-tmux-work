#!/usr/bin/env bash

set -o errexit
set -o pipefail
set -o nounset

tmux new-session -s "Work" -n "Local" -d

ac-tmux-common

tmux new-window -n "Raijin" "while true ; do ssh raijin ; sleep 30 ; done"
tmux split-window -h "while true ; do ssh -t raijin \"watch --interval 60 --no-title 'qstat -u ajc566 | tail -n +3' \" ; sleep 30 ; done"
tmux split-window -v "while true ; do ssh -t raijin 'top -M -u ajc566' ; sleep 30 ; done"
tmux select-pane -t 0

tmux new-window -n "HLRN (Hannover)" "while true ; do ssh hlrn-hannover ; sleep 30 ; done"
# tmux split-window -h "while true ; do ssh -t hlrn-hannover \"watch --no-title --interval 120 'showq -u hhpchamb | tail -n +2' \" ; sleep 30 ; done"
tmux split-window -h "while true ; do ssh -t hlrn-hannover 'top -u hhpchamb' ; sleep 30 ; done"
tmux select-pane -t 0

tmux new-window -n "Phoenix" "while true ; do ssh phoenix ; sleep 30 ; done"
tmux split-window -v -p 33 "while true ; do ssh -t phoenix 'top -u a1210233' ; sleep 30 ; done"
tmux select-pane -t 0

tmux new-window -n "Erwin" "while true ; do ssh erwin ; sleep 30 ; done"
tmux split-window -v -p 33 "while true ; do ssh -t erwin 'top -M -u achambers' ; sleep 30 ; done"
tmux select-pane -t 0

tmux select-window -t "Local"
tmux attach-session -t "Work"
